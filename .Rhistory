ggplot(d)+
aes(x = offset, y = bias)+
geom_jitter(size = 2, alpha = 0.5, width = 0.2,height=0.02)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"))+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "red")+
geom_vline(xintercept = 0, lty = "dashed", col = "red")+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_jitter(size = 2, alpha = 0.5, width = 0.2,height=0.02)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"))+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = 0, lty = "dashed", col = "red")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_jitter(size = 2, alpha = 0.5, width = 0.2,height=0.02)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = 0, lty = "dashed", col = "red")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_jitter(size = 2, alpha = 0.5, width = 0.2,height=0.02)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = 0)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 2, alpha = 0.5, width = 0.2,height=0.02)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.5, width = 0.2,height=0.02, col = "pink")+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "red")+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias, fill = offset)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "red",
stroke = 1.2, shape = 13)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 23)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 22)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), colour="blue", size=4)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=21,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue")+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1.5)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue")+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1.2)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1.2)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif\nde la ligne)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("50%\nvotre milieu subjectif\nest de",round(pse,1)),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("50%\nvotre milieu\nsubjectif\nest de\n",
round(pse,1), "mm"),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("50%\nvotre milieu\nsubjectif est de\n",
round(pse,1), "mm"),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("votre milieu\nsubjectif est de\n",
round(pse,1), "mm"),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("50%\nvotre milieu\nsubjectif est de\n",
round(pse,1), "mm"),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
for(i in list.files(path = here::here("data"))) {
d<-read.csv(here::here("data", i), header=T)
d<-d[-seq(1:21),] %>%
select(offset, resp.keys) %>%
#90 trials
mutate(bias = ifelse(resp.keys == "e",0,1))
mod<-glm(bias ~ offset, family = binomial(link = "logit"), data = d)
sum<-summary(mod)
coeff<-t(as.matrix(sum$coefficients[, "Estimate"]))
colnames(coeff)<-c("intercept", "offset")
coeff<-as.data.frame(coeff)
pse <- -coeff$intercept/coeff$offset
slope <- coeff$offset
jnd <- log(3/slope)
p<-ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("50%\nvotre milieu\nsubjectif est de\n",
round(pse,1), "mm"),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
p2<-ggplot(d)+
aes(x = offset, y = bias)+
geom_jitter(size = 2, alpha = 0.5, width = 0.2,height=0.02)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"))+
geom_hline(yintercept = 0.50, lty = "dashed", col = "red")+
geom_vline(xintercept = 0, lty = "dashed", col = "red")+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\n(réponse gauche)","50%\n(milieu subjectif)", "100%\n(réponse droite)"))+
labs(y="% de réponse 'côté droit le plus court'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
name_subject<-substr(i, start = 1, stop = 8)
png(filename = paste0("plot",name_subject,".png"))
print({
p
})
dev.off()
}
result = list()
result = list()
for(i in list.files(path = here::here("data"))) {
d<-read.csv(here::here("data", i), header=T)
d<-d[-seq(1:21),] %>%
select(offset, resp.keys) %>%
#90 trials
mutate(bias = ifelse(resp.keys == "e",0,1))
mod<-glm(bias ~ offset, family = binomial(link = "logit"), data = d)
sum<-summary(mod)
coeff<-t(as.matrix(sum$coefficients[, "Estimate"]))
colnames(coeff)<-c("intercept", "offset")
coeff<-as.data.frame(coeff)
pse <- -coeff$intercept/coeff$offset
slope <- coeff$offset
jnd <- log(3/slope)
p<-ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("50%\nvotre milieu\nsubjectif est de\n",
round(pse,1), "mm"),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
name_subject<-substr(i, start = 1, stop = 8)
result[[i]]<- c(pse, slope, jnd)
png(filename = paste0("plot",name_subject,".png"))
print({
p
})
dev.off()
}
result
as.data.frame(c(pse, slope, jnd))
as.data.frame(pse, slope, jnd)
as.matrix(pse, slope, jnd)
as.matrix(c(pse, slope, jnd))
((as.matrix(c(pse, slope, jnd)))
result[[i]]<-
png(filename = paste0("plot",name_subject,".png"))
print({
p
})
dev.off()
}
result
as.matrix(c(pse, slope, jnd))
as.matrix(c(pse, slope, jnd)) %>% t
mat<-as.matrix(c(pse, slope, jnd)) %>% t
colnames(mat)<-c("pse", "slope", "jnd")
mat
mat<-as.data.frame(mat)
mat
for(i in list.files(path = here::here("data"))) {
d<-read.csv(here::here("data", i), header=T)
d<-d[-seq(1:21),] %>%
select(offset, resp.keys) %>%
#90 trials
mutate(bias = ifelse(resp.keys == "e",0,1))
mod<-glm(bias ~ offset, family = binomial(link = "logit"), data = d)
sum<-summary(mod)
coeff<-t(as.matrix(sum$coefficients[, "Estimate"]))
colnames(coeff)<-c("intercept", "offset")
coeff<-as.data.frame(coeff)
pse <- -coeff$intercept/coeff$offset
slope <- coeff$offset
jnd <- log(3/slope)
p<-ggplot(d)+
aes(x = offset, y = bias)+
geom_vline(xintercept = 0)+
geom_hline(yintercept = 0.50, lty = "dashed", col = "blue", size=1)+
geom_vline(xintercept = pse, lty = "dashed", col = "blue", size=1)+
scale_x_continuous(limits=c(-10.5,10.5),breaks = seq(-10,10,1))+
geom_smooth(method = "glm", method.args = list(family = "binomial"),
se = F, size=2)+
geom_jitter(size = 3, alpha = 0.7, width = 0.2,height=0.02, col = "black",fill="red",
stroke = 1.2, shape = 21)+
geom_point(aes(x=pse, y=0.5), fill="red", size=5, col = "black", shape=24,
stroke = 1.5)+
scale_y_continuous(limits=c(-0.1,1.1),breaks = seq(0,1,0.5),
labels = c("0%\nréponse gauche",
paste0("50%\nvotre milieu\nsubjectif est de\n",
round(pse,1), "mm"),
"100%\nréponse droite"))+
labs(y="% de réponse 'ligne coupée à droite'", x= "Décalage de la ligne verticale \npar rapport au milieu (mm)")+
theme_bw(base_size = 16)
name_subject<-substr(i, start = 1, stop = 8)
mat<-as.matrix(c(pse, slope, jnd)) %>% t
colnames(mat)<-c("pse", "slope", "jnd")
mat<-as.data.frame(mat)
result[[i]]<- mat
png(filename = paste0("plot",name_subject,".png"))
print({
p
})
dev.off()
}
bind.rows(result)
bind_rows(result)
df<-bind_rows(result)
t.test(pse ~0, df)
?t.test
t.test(pse ~ 1, df)
mean(df$pse)
t.test(pse ~ 1, df)
